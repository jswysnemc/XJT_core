<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ljp.xjt.mapper.TeacherMapper">

    <!-- 通用查询映射结果 -->
    <resultMap id="BaseResultMap" type="com.ljp.xjt.entity.Teacher">
        <id column="id" property="id" />
        <result column="user_id" property="userId" />
        <result column="teacher_number" property="teacherNumber" />
        <result column="teacher_name" property="teacherName" />
        <result column="gender" property="gender" />
        <result column="title" property="title" />
        <result column="department_id" property="departmentId" />
        <result column="created_time" property="createdTime" />
        <result column="updated_time" property="updatedTime" />
    </resultMap>

    <!-- 分页查询教师列表 -->
    <select id="selectTeacherList" resultMap="BaseResultMap">
        SELECT * FROM teachers
        <where>
            <if test="teacherName != null and teacherName != ''">
                AND teacher_name LIKE CONCAT('%', #{teacherName}, '%')
            </if>
            <if test="departmentId != null">
                AND department_id = #{departmentId}
            </if>
        </where>
        ORDER BY created_time DESC
    </select>

    <!-- 根据用户ID查询教师信息 -->
    <select id="selectByUserId" resultMap="BaseResultMap">
        SELECT * FROM teachers WHERE user_id = #{userId} LIMIT 1
    </select>

    <!-- 检查教工号是否存在 -->
    <select id="checkTeacherNumberExists" resultType="java.lang.Integer">
        SELECT COUNT(*) FROM teachers WHERE teacher_number = #{teacherNumber}
    </select>

</mapper> 